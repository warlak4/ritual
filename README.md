# ¬´–†–∏—Ç—É–∞–ª—å¬ª ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∏—Ç—É–∞–ª—å–Ω—ã—Ö —É—Å–ª—É–≥

–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —É—á—ë—Ç–∞ –∑–∞—è–≤–æ–∫, —Ü–µ—Ä–µ–º–æ–Ω–∏–π, —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ —Ä–∏—Ç—É–∞–ª—å–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ë–î (SQL Server 2022) —Å –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏, —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏, –∞—É–¥–∏—Ç–æ–º –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º;
- backend –Ω–∞ NestJS (RBAC, JWT, OpenAPI, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫–æ–Ω—Ç—Ä–æ–ª—å –æ—à–∏–±–æ–∫);
- frontend (React + Vite) —Å i18n, –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –≤–µ—Ä—Å—Ç–∫–æ–π, —Ö–æ—Ç–∫–µ—è–º–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è–º–∏;
- DevOps-–ø—Ä–∞–∫—Ç–∏–∫–∏ (Docker Compose, —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/restore, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ).

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

| –°–ª–æ–π       | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏                                                                              |
|------------|------------------------------------------------------------------------------------------|
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö| Microsoft SQL Server 2022, —Å—Ö–µ–º—ã `domain`, `ref`, `audit`, –ø—Ä–æ—Ü–µ–¥—É—Ä—ã `sp_*`, Always Encrypted |
| Backend    | Node.js 20, NestJS 11, TypeORM, JWT, bcrypt, Swagger, Redis (–æ—á–µ—Ä–µ–¥–∏/–∫—ç—à), MinIO (—Ñ–∞–π–ª—ã) |
| Frontend   | React 19, Vite 7, TypeScript, React Query, Zustand, i18next, Recharts                    |
| –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ | Docker Compose, Nginx (frontend), sqlcmd —Å–∫—Ä–∏–ø—Ç—ã, k6 –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤             |

–î–æ–∫—É–º–µ–Ω—Ç—ã: `docs/01_domain_analysis.md`, `docs/02_data_model.md`, `docs/03_architecture.md`.

## –ó–∞–ø—É—Å–∫

### Docker (–ø–æ–ª–Ω—ã–π —Å—Ç–µ–∫)
```bash
docker compose -f ops/docker-compose.yml up --build
# Backend ‚Üí http://localhost:3000 (Swagger: /api/docs)
# Frontend ‚Üí http://localhost:5173
```

### –õ–æ–∫–∞–ª—å–Ω–æ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ SQL Server)
```bash
# 1. SQL Server (docker –∏–ª–∏ on-premises)
sqlcmd -S localhost,1433 -U sa -P 'YourStrong!Passw0rd' -i db/scripts/00_prerequisites.sql
sqlcmd -S localhost,1433 -U sa -P 'YourStrong!Passw0rd' -i db/scripts/01_tables.sql
...

# 2. Backend
cd backend
cp .env.example .env
npm install
npm run start:dev

# 3. Frontend
cd ../frontend
npm install
npm run dev
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
backend/    - NestJS API, –º–æ–¥—É–ª–∏, —Å—É—â–Ω–æ—Å—Ç–∏, —Ç–µ—Å—Ç—ã, Dockerfile
frontend/   - React SPA, i18n, Zustand store, Dockerfile
db/scripts/ - SQL: —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î, –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, —Ç—Ä–∏–≥–≥–µ—Ä—ã, —Å–∏–¥—ã, backup/restore
docs/       - –ü–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ç–µ—Å—Ç—ã, —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è
ops/        - docker-compose.yml –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
```

## –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü–æ–ª—è `clients.address_encrypted`, `clients.passport_encrypted` ‚Äî —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (`ClientDataKey` + —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç).
- –ü–∞—Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî `bcrypt` (cost 12).
- RBAC: `admin`, `client`, `guest`; —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–æ–ª–∏ –ë–î (`ritual_admin`, `ritual_manager`, `ritual_guest`).
- –ê—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞–∫–∞–∑–æ–≤ ‚Äî —Ç—Ä–∏–≥–≥–µ—Ä `audit.trg_orders_audit` + –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `audit_log`.

## –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°–∫—Ä–∏–ø—Ç `db/scripts/07_backup.sql` —Å–æ–∑–¥–∞—ë—Ç FULL/Diff/Log backup –∏ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `admin.backup_jobs`.
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: `db/scripts/08_restore.sql` (demonstration restore + smoke-—Ç–µ—Å—Ç—ã).
- –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ ‚Äî `docs/06_operations.md`.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- Unit/Integration: `backend/test/*` (Jest, Supertest).
- UI: Playwright (`frontend/tests/e2e`).
- –ù–∞–≥—Ä—É–∑–∫–∞: k6 (`tests/load/orders-load.js`).
- Security baseline: OWASP ZAP.
- –ü–ª–∞–Ω –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Äî `docs/05_testing.md`.

## API –∏ UI
- Swagger UI: `http://localhost:3000/api/docs`.
- SPA (React): `http://localhost:5173` ‚Äî –¥–∞—à–±–æ—Ä–¥, –∑–∞—è–≤–∫–∏, –∫–ª–∏–µ–Ω—Ç—ã, —Ü–µ—Ä–µ–º–æ–Ω–∏–∏, —Ä–µ—Å—É—Ä—Å—ã, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
- –•–æ—Ç–∫–µ–∏ (`Ctrl+N`, `Ctrl+F`, `Shift+L`, `Shift+T`, `Ctrl+S`, `Ctrl+Shift+F`, `Ctrl+Shift+A`, `Ctrl+Shift+O`) –æ–ø–∏—Å–∞–Ω—ã –≤ UI –∏ `docs`.

## –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

### Render.com

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω–∞ [Render.com](https://render.com):

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π GitHub –∫ Render:**
   - –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [render.com](https://render.com) –∏ —Å–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç
   - –ù–∞–∂–º–∏—Ç–µ "New" ‚Üí "Blueprint" (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã)
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∞—à GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `warlak4/ritual`
   - Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç `render.yaml` –∏ —Å–æ–∑–¥–∞—Å—Ç —Å–µ—Ä–≤–∏—Å—ã

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Render Dashboard:**

   **–î–ª—è Backend —Å–µ—Ä–≤–∏—Å–∞ (`ritual-backend`):**
   ```
   DB_HOST=your-sql-server-host.database.windows.net  # –∏–ª–∏ –¥—Ä—É–≥–æ–π —Ö–æ—Å—Ç
   DB_USER=your-db-user
   DB_PASSWORD=your-secure-password
   CORS_ORIGINS=https://ritual-frontend.onrender.com
   JWT_SECRET=<—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π>
   CRYPTO_MASTER_KEY=<—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ 32-–±–∞–π—Ç–Ω—ã–π hex>
   ```

   **–î–ª—è Frontend —Å–µ—Ä–≤–∏—Å–∞ (`ritual-frontend`):**
   ```
   VITE_API_BASE_URL=https://ritual-backend.onrender.com
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:**
   - SQL Server –º–æ–∂–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –Ω–∞ Azure SQL Database, AWS RDS –∏–ª–∏ –¥—Ä—É–≥–æ–º —Ö–æ—Å—Ç–∏–Ω–≥–µ
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ PostgreSQL (–ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã)
   - –£–∫–∞–∂–∏—Ç–µ —Ö–æ—Å—Ç, –ø–æ—Ä—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è backend

4. **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
   - Backend –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `https://ritual-backend.onrender.com`
   - Frontend –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `https://ritual-frontend.onrender.com`
   - Swagger API: `https://ritual-backend.onrender.com/api/docs`

### –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è –†–æ—Å—Å–∏–∏ üá∑üá∫

üìã **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** —Å–º. —Ñ–∞–π–ª `DEPLOY_FREE_RU.md`

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:**

1. **Yandex Cloud** ‚≠ê (–õ—É—á—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è –†–æ—Å—Å–∏–∏)
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –ø–∞–∫–µ—Ç: 4000‚ÇΩ –Ω–∞ 60 –¥–Ω–µ–π
   - Compute Cloud (VM) –¥–ª—è backend
   - Object Storage + CDN –¥–ª—è frontend
   - Managed PostgreSQL –¥–ª—è –ë–î
   - –ü–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –†–æ—Å—Å–∏–∏

2. **Selectel** (–†–æ—Å—Å–∏–π—Å–∫–∏–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä)
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ VPS
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Docker
   - –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º

3. **Timeweb Cloud** (–†–æ—Å—Å–∏–π—Å–∫–∏–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä)
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥
   - VPS —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Node.js
   - –ü—Ä–æ—Å—Ç–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

4. **GitHub Pages** (–¢–æ–ª—å–∫–æ Frontend)
   - –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –∏–∑ GitHub
   - Backend –Ω—É–∂–Ω–æ —Ä–∞–∑–º–µ—â–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

**–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Yandex Cloud:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è VM
bash yandex-cloud-deploy.sh

# –ò–ª–∏ –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker Compose
docker-compose -f docker-compose.prod.yml up -d
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ)

- **Railway.app** ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ Render, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Docker
- **Heroku** ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç (–ø–ª–∞—Ç–Ω—ã–π)
- **DigitalOcean App Platform** ‚Äî —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ
- **VPS** (Hetzner, DigitalOcean) ‚Äî –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- ‚ö†Ô∏è SQL Server —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∏–Ω–≥–∞ (Azure SQL, AWS RDS, –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä)
- üîí –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –≤—Å–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- üåê –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞ frontend
- üìä –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω Render (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω –º–æ–∂–µ—Ç "–∑–∞—Å—ã–ø–∞—Ç—å")

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
- –ú–∏–≥—Ä–∞—Ü–∏–∏ TypeORM, —Å–∫—Ä–∏–ø—Ç—ã —Å–∏–¥–æ–≤, –∫–æ–¥—ã –ø—Ä–∏–º–µ—Ä–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã –≤ `db/scripts`.
- –ö–æ–º–∞–Ω–¥—ã CI/CD –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É ‚Äî `docs/06_operations.md`.
- –í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å–∫–∏ —Å–æ–±—Ä–∞–Ω—ã –≤ `docs/`.

---
–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ ‚Äî —Å–º. `docs/03_architecture.md` (—Å—Ö–µ–º—ã —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç).
